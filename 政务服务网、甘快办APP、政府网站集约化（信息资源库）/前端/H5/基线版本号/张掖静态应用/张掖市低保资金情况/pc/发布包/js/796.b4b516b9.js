"use strict";(self["webpackChunkxsecmcx"]=self["webpackChunkxsecmcx"]||[]).push([[796],{4796:function(e,a,t){t.r(a),t.d(a,{default:function(){return w}});var n=function(){var e=this,a=e._self._c;return a("div",[a("section",{staticClass:"query-container"},[a("el-form",{ref:"formData",attrs:{action:"",model:e.formData,rules:e.formRules,"label-position":"right","label-width":"120px"}},[a("el-form-item",{attrs:{label:"地区区县"}},[a("el-select",{staticClass:"slt",attrs:{clearable:!1,"prefix-icon":"el-icon-document",placeholder:"请选择地区区县"},model:{value:e.formData.quxian,callback:function(a){e.$set(e.formData,"quxian",a)},expression:"formData.quxian"}},e._l(e.options,(function(e){return a("el-option",{key:e.code,attrs:{label:e.name,value:e.name}})})),1)],1),a("div",{staticClass:"verification-code"},[a("el-form-item",{attrs:{label:"验证码",prop:"code"}},[a("el-input",{staticClass:"yanzhengma",attrs:{placeholder:"请输入验证码","prefix-icon":"el-icon-edit",maxlength:"4",onkeyup:"value=value.replace(/[\\u4e00-\\u9fa5]/ig,'')"},on:{input:e.inputKeyUp},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.queryList("formData")}},model:{value:e.formData.code,callback:function(a){e.$set(e.formData,"code",a)},expression:"formData.code"}})],1),a("div",{staticClass:"code",on:{click:e.updateCode}},[a("canvas",{attrs:{id:"canvas",width:"100",height:"38"}})])],1),a("div",{staticClass:"form-btn"},[a("input",{staticClass:"submit",attrs:{type:"button",value:"查询"},on:{click:function(a){return e.queryList("formData")}}}),a("input",{attrs:{type:"reset",value:"重置"},on:{click:function(a){return e.resetForm("formData")}}})])],1)],1),a("router-view",{key:e.key})],1)},r=[],s=t(6265),o=t.n(s);const i=e=>{const a=new URLSearchParams;return a.append("app_id","sx"),a.append("interface_id","qhwjld"),a.append("version","1.0"),a.append("biz_content",JSON.stringify({areaCode:e||""})),a.append("charset","UTF-8"),a.append("origin","0"),a.append("timestamp",(new Date).valueOf()),new Promise(((e,t)=>{o()({method:"post",url:"https://zwfw.gansu.gov.cn/jpaas-jags-server/interface/createsign.do",data:a}).then((n=>{a.append("sign",n.data.data.sign),o()({method:"post",url:"https://zwfw.gansu.gov.cn/jpaas-jags-server/interface/gateway.do",data:a}).then((a=>{e(JSON.parse(a.data.data))})).catch((e=>{t(e)}))})).catch((e=>{t(e)}))}))};let c="";function d(){let e=Math.floor(256*Math.random()),a=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb("+e+","+a+","+t+")"}function p(e){let a=[],t=document.getElementById("canvas").width,n=document.getElementById("canvas").height,r=document.getElementById("canvas"),s=r.getContext("2d");r.width=t,r.height=n;let o=e,i=o.split(",");for(let c=0;c<1;c++){let e=15*Math.random()*Math.PI/180,t=i[c];a[c]=t?.toLowerCase();let n=10+13*c,r=20+3*Math.random();s.font="bold 20px 微软雅黑",s.translate(n,r),s.rotate(e),s.fillStyle=d(),s.fillText(t,0,0),s.rotate(-e),s.translate(-n,-r)}for(let c=0;c<=5;c++)s.strokeStyle=d(),s.beginPath(),s.moveTo(Math.random()*t,Math.random()*n),s.lineTo(Math.random()*t,Math.random()*n),s.stroke();for(let c=0;c<=30;c++){s.strokeStyle=d(),s.beginPath();let e=Math.random()*t,a=Math.random()*n;s.moveTo(e,a),s.lineTo(e+1,a+1),s.stroke()}c=a.join("")}const h="https://zwfw.gansu.gov.cn/jpaas-jags-server/interface/",u={createSignJpaas:function(e={}){return new Promise(((a,t)=>{o()({method:"post",url:`${h}createsign`,data:e}).then((function(e){if(e.data.success){const{sign:t}=e.data.data;a(t)}else t(e)})).catch((function(e){t(e)}))}))},getDataFromJpaas:function(e={}){return new Promise(((a,t)=>{o()({method:"post",url:`${h}gateway`,data:e}).then((function(e){if(200==e.data.code&&1==e.data.success){const n=JSON.parse(e.data.data);if(200==n.code)a(n);else{const a=JSON.parse(JSON.parse(e.data.data).data);t(a)}}else t(e)})).catch((function(e){t(e)}))}))},getData:function({columnId:e="",params:a={}}={}){const t=new URLSearchParams;return t.append("header","{}"),t.append("version","1.0"),t.append("charset","UTF-8"),t.append("origin","1"),t.append("timestamp",(new Date).getTime()),t.append("interface_id","showVerifyCode"),t.append("app_id","yzm"),t.append("biz_content",JSON.stringify(Object.assign({}))),new Promise(((e,a)=>{u.createSignJpaas(t).then((e=>(t.append("sign",e),u.getDataFromJpaas(t)))).then((a=>{try{var t=JSON.parse(a);e("object"===typeof t&&t?JSON.parse(a):a)}catch(n){e(a)}})).catch((e=>{a(e)}))}))}},l={createSignJpaas:function(e={}){return new Promise(((a,t)=>{o()({method:"post",url:`${h}createsign`,data:e}).then((function(e){if(e.data.success){const{sign:t}=e.data.data;a(t)}else t(e)})).catch((function(e){t(e)}))}))},getDataFromJpaas:function(e={}){return new Promise(((a,t)=>{o()({method:"post",url:`${h}gateway`,data:e}).then((function(e){const t=JSON.parse(e.data.data);a(t)})).catch((function(e){t(e)}))}))},getData:function(e){const a=new URLSearchParams;return a.append("header","{}"),a.append("version","1.0"),a.append("charset","UTF-8"),a.append("origin","1"),a.append("timestamp",(new Date).getTime()),a.append("interface_id","cheackCaptcha"),a.append("app_id","yzm"),a.append("biz_content",JSON.stringify(Object.assign(e))),new Promise(((e,t)=>{l.createSignJpaas(a).then((e=>(a.append("sign",e),l.getDataFromJpaas(a)))).then((a=>{try{var t=JSON.parse(a);e("object"===typeof t&&t?JSON.parse(a):a)}catch(n){e(a)}})).catch((e=>{t(e)}))}))}};var m={name:"IndexView",created(){i("620700000000").then((e=>{e.data.forEach((e=>{e.name.includes("张掖")&&(e.name="张掖市"),e.name.includes("肃南")&&(e.name="肃南县")})),this.options=e.data}),(e=>{})),this.$router.push({name:"Results",params:{res:JSON.stringify(this.formData)}})},async mounted(){await this.queryCode(),this.$nextTick((()=>{p(this.captcha.sandCode)}))},data(){const e=async(e,a,t)=>{if(await this.verifyCode(),!this.codeFlag)return this.formData.code="",t(new Error("验证码错误"));t()},a=(e,a,t)=>{this.checkSpecialKeyCode(a)?a.includes(" ")?t(new Error("不能含有特殊字符")):t():t(new Error("不能含有特殊字符"))};let t=(e,a,t)=>{this.checkSpecialKey(a)?a.includes(" ")?t(new Error("不能含有特殊字符")):t():t(new Error("不能含有特殊字符"))};return{key:0,isOpenResult:!1,formData:{quxian:"",name:"",code:"",selectName:"",selectArr:[]},options:[],cityArr:[],show:!0,phone:"",code:"",formRules:{code:[{required:!0,message:"验证码不能为空",trigger:"blur"},{min:4,max:4,message:"验证码长度为4个字符",trigger:"blur"},{validator:a,trigger:"blur"},{validator:e,trigger:"click"}],quxian:[{validator:t,trigger:"blur"}]},value:"",captcha:{uuid:"",sandCode:""},codeFlag:!1}},methods:{checkSpecialKey(e){let a="/[`-~!@#$^&*=|{}':;',\\\\\\[\\]\\.<>\\/?~！@#￥……&%*（）——|{}【】'；：\"\"'。，、？\\]/";for(let t=0;t<e.length;t++)if(-1!=a.indexOf(e.substr(t,1)))return!1;return!0},checkSpecialKeyCode(e){let a="/[`-~!@#$^&*=|{}':;',\\\\\\[\\]\\.<>\\/?~！@#￥……&%*（）——|{}【】'；：\"\"'。，、？\\]/";for(let t=0;t<e.length;t++)if(-1!=a.indexOf(e.substr(t,1)))return!1;return!0},async queryList(e){this.$refs[e].validate((async e=>{if(await this.updateCode(),this.formData.code="",!e)return!1;this.formData.quxian=this.formData.quxian.replace(/\s+/g,""),this.$router.push({name:"Index"}),this.formData,this.$router.push({name:"Results",params:{res:JSON.stringify(this.formData)}})}))},resetForm(e){this.updateCode(),this.$refs[e].resetFields(),this.formData.selectName="",this.formData.quxian="",this.$router.push({name:"Index"}),this.$router.push({name:"Results",params:{res:JSON.stringify(this.formData),flage:"resetForm"}})},async queryCode(){const e=await u.getData().catch((e=>{}));e&&("200"===e.code?(this.captcha.uuid=e.data.captcha.uuid,this.captcha.sandCode=e.data.captcha.capStr):this.$message({type:"error",message:"验证码获取失败，请重试或联系管理员"}))},async updateCode(){this.captcha.uuid="",this.captcha.sandCode="",await this.queryCode(),p(this.captcha.sandCode)},async verifyCode(){try{let e=new FormData;e.append("uuid",this.captcha.uuid),e.append("sandCode",this.formData.code),this.captcha.sandCode=this.formData.code;const a=await l.getData(this.captcha);"200"==a.code?this.codeFlag=!0:this.codeFlag=!1}catch(e){this.$message({type:"error",message:"验证码校验失败，请重试或联系管理员"})}},keyUp(e){const a=/[`~!@#$^&*()=|{}':;',\\\[\]\.<>\/?~！@#￥……&%*（）——|{}【】'；：""'。，、？\s]/g;this.formData[e]=this.formData[e].replace(a,"")},inputKeyUp(){const e=/[`~!@#$^&*()=|{}':;',\\\[\]\.<>\/?~！@#￥……&%*（）——|{}【】'；：""'。，、？\s]/g;this.formData.code=this.formData.code.replace(e,"")}}},f=m,g=t(1001),y=(0,g.Z)(f,n,r,!1,null,"60fbb6f2",null),w=y.exports}}]);